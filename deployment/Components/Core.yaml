apiVersion: v1
kind: Namespace
metadata:
  labels:
    name: core
  name: core
---
#check more at https://www.rabbitmq.com/kubernetes/operator/using-operator.html
#and https://github.com/rabbitmq/cluster-operator/tree/main/docs/examples/production-ready
apiVersion: rabbitmq.com/v1beta1
kind: RabbitmqCluster
metadata:
  name: rmq
  namespace: core
  labels:
    app: rmq
#spec:
####### if we want to expose rmq outside the cluster
#  service:
#    type: LoadBalancer
####### if we want to limit resource...
#  replicas: 1
#  resources:
#    requests:
#      cpu: 500m
#      memory: 1Gi
#    limits:
#      cpu: 800m
#      memory: 1Gi
---
# NOT Unstable yet
#apiVersion: apps/v1
#kind: Deployment
#metadata:
#  labels: null
#  name: timeestimator
#  namespace: core
#spec:
#  replicas: 1
#  selector:
#    matchLabels:
#      app: timeestimator
#  template:
#    metadata:
#      labels:
#        app: timeestimator
#    spec:
#      containers:
#      - image: cxd9974/msc_timeestimator:latest
#        name: timeestimator
#        ports:
#        - containerPort: 5672
#        env:
#        - name: USERNAME
#          valueFrom:
#            secretKeyRef:
#              name: rmq-default-user
#              key: username
#        - name: PASSWORD
#          valueFrom:
#            secretKeyRef:
#              name: rmq-default-user
#              key: password
#          ##set PYTHONIOENCODING=UTF-8
#        - name: PYTHONIOENCODING
#          value: "UTF-8"
#          ###debug logs, enable 2 lines below to see print from python, disable on production
#        - name: PYTHONUNBUFFERED
#          value: "1"
